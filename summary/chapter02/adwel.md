# Chapter 01 마이크로 서비스 모델링 방법
```
마이크로 서비스의 경계를 정의하는 기준은 무엇이고 주로
해당 기준을 나누기 위해 주로 사용되는 매커니즘에 대해 알아보자
```
## 서비스의 경계를 나누는 개념
서비스관의 관계를 정의하고 적합한 경계를 찾는데 도움이 되는 주요 개념

### 정보은닉

- 내부에서 구현된 세부 사항을 외부에 드러내지 않고 인터페이스와 상호 작용 해야 함  
- 마이크로 서비스는 모듈식 아키텍처의 한 형태이고 그 모듈의 경계를 정의하는 가장 효과적인 방법이 정보 은닉  
- 서비스는 자신의 상태를 독립된 공간에서 관리 해야하며 그에 따라 내부를 보호할 수 있음

### 응집력
- 정의된 경계 내에서 모듈, 서비스 구성 요소들이 관련되어 있어야 함
- 연관 있는 기능들을 한 곳으로 모으고 하나의 목적으로 이용해야 함

### 결합
- 경계로 나누어진 서비스는 독립적으로 동작할 수 있고 경계간 결합은 느슨하게 유지 해야함
- 시스템의 유지보수, 확장, 재 사용설을 높일 수 있음

#### 결합 종류
- 도메인 결합
    - 일반적으로 불가피한 결합
    - 가장 기본적이고 느슨한 결합이지만 많아지면 문제가 발생 될 수 있음
    - 느슨한 결합이지만 최소한으로 유지 할 수 있도록 노력
- 통과 결합
    - 데이터가 여러 경계를 경유하면서 발생하는 결합
    - 강력한 결합이 생겨 전체 서비스를 수정해야 할 수 있음
    - 데이터는 가공하지 않고 단지 전달 하는 형태로 결합도를 낮출 수 있음
    - 결합도를 낮춰도 릴리즈를 동시에 해야함, 하지만 시점은 다르게 가져갈 수 있음
- 공통 결합
    - 서로 다른 서비스가 동일한 데이터 베이스에 접근하기 위해 같은 해당 데이터 베이스를 관리하는 서비스와 결합
    - 공통 서비스에 접근하면서 리소스 경합 문제가 발생할 수 있음
    - 일반적으로 많이 발생하는 결합이지만 최소한으로 유지
- 내용 결합
    - 경계 밖에 있는 서비스가 내부에 있는 데이터 베이스에 직접 액세스
    - 반드시 피해야 하는 경합

## DDD로 모델링
마이크로 서비스의 경계를 찾는데 도움을 주는 가장 강력하고 기본적인 메커니즘

### 보편언어
- 사용자가 쓰는 용어를 코드에서도 동일하게 사용

### 애그리거트
- 하나의 서비스가 독립적으로 관리하는 객체 그룹
- 마이크로 서비스는 여러 애그리거트를 가질 수 있지만 애그리거트는 하나의 서비스에서 관리되어야 함

### 경게콘텍스트
외부 시스템과 느슨한 결합으로 상호작용하기 위해 정의된 인터페이스로만 데이터를 전달  
경계콘텍스트는 여러 경계의 집합일 수도 있음

- 은닉모델
    - 내부 구현 세부 사항을 숨기며 외부에는 명시적인 인터페이스만 제공 한다 

- 공유모델
    - 서로다른 경계콘텍스트에서 같은 데이터를 다른 의미로 소유할 수 있음을 의미


## DDD가 아닌 다른 방법은?

### 데이터
- 서비스 관점에서 벗어나 특별하게 관리되어야 하는 데이터가 있다면 그 기준으로 경계를 정의할 수 있음
- 대표적으로 법적으로 관리되어야 하는 개인정보 데이터가 있음

### 변동성
- 서비스에서 변동성이 빈번하게 발생하는 부분을 기준으로 경계를 정의
- 다른 서비스에 영향을 주지 않고 유지보수에 용이
- 해당 기준으로 경계를 정의하는 것은 장기적으로 좋진 않음 때문에 권장하지 않음 

### 기술 및 조직
- 조직으로 경계를 정의하면 효율적인 협업가능
- 독립적인 배포로 서비스 운영 및 유지보수 효율성이 높아짐