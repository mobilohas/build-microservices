# 조직 구조

## 느슨하게 결합된 조직
- 조직 구조의 변화 없이 이뤄지는 마이크로서비스 아키텍처로의 전환은 유용성을 저하시킬 것임
- 팀이 시스템에 대한 완전한 주인의식을 갖게 하려면, 아키텍처에 대한 의사결정 방식을 포함해 중앙 집중식 통제에서 벗어나야 함
- 느슨하게 결합된 조직 구조를 달성하려면 권한과 책임이 분산되어야 함
- 느슨하게 결합된 조직이 느슨하게 결합된 아키텍처를 만들게 됨

### 자율적이고 느슨하게 결합되는 팀
- 팀은 팀 외부 누군가의 허가 없이 시스템 설계에 대규모 변경을 가할 수 있음
- 팀은 시스템을 변경하는 과정에서 다른 팀에 의존하지 않거나 다른 팀을 위해 중요한 작업을 수행하지 않고도 시스템 설계에 대규모 변경을 가할 수 있음
- 팀은 팀 외부의 사람들과 소통하거나 조정하지 않고도 작업을 완료할 수 잇음
- 팀은 의존하는 다른 서비스에 관계없이 필요에 따라 제품과 서비스를 배포하고 릴리스 할 수 있음
- 팀은 통합된 테스트 환경 없이도 대부분의 테스트를 필요에 따라 수행할 수 있음
- 팀은 다운타임이 거의 없이 정상 업무 시간 동안 배포를 수행할 수 있음

### 증거
#### 느슨하거나 강하게 결합된 조직
- 강하게 결합된 조직은 일반적으로 확실하게 정렬된 비전과 목표를 설정한 회사
- 느슨하게 결합된 조직은 분산된 오픈 소스 커뮤니티
- 느슨하게 결합된 조직이 실제로 더 모듈화되고 덜 결합된 시스템을 만듬

### 윈도 비스타
- 마이크로소프트에서 조직 구조 자체가 윈도 비스타의 품질에 어느 정도 영향을 미치는지 연구함
- 코드 복잡성과 같은 소프트웨어 품질 지표와 다른 여러 지표를 확인한 후 조직구조가 가장 관련성이 높은 요소인 것을 발견

### 넷플릭스와 아마존
- 아마존은 시스템의 전체 수명주기를 소유한 팀, 구성원이 작은 팀이 업무 효율이 좋다는것을 발견 (피자 한판의 조각 보다 작은 팀)
- 넷플릭스는 아마존의 사례를 교훈 삼아 처음부터 작고 독립적인 팀을 구성 

## 팀 규모
- 일반적으로 9명 이상일 경우 프로젝트 생산성이 가장 낮다는 연구 결과가 있음
- 소수의 인원은 모두 동일한 결과에 집중하고 의견, 업무 조율을 하기 쉬움

## 콘웨이의 법칙 이해
- 변경을 더 쉽게 수용하도록 느슨하게 결합된 아키텍처를 바란다면 느슨하게 결합된 조직이 필요
- 느슨하게 결합된 조직은 여러 부분에서 더 빠르고 효율적으로 결정하고 행동할 수 있어 큰 도움이 됨
- 중앙 집중식 명령과 통제 모델은 의사결정으로 인해 조직이 대응할 수 있는 속도가 크게 느려짐

## 소규모 팀, 대규모 조직
- 더 빨리 문제를 해결하고자 더 많은 사람을 투입하는 방법은 좋지 않음
- 효율적으로 대규모 작업을 하는 데 가장 비용이 많이 드는 것은 조정 활동
- 팀은 독립적일 수록 더욱 신속하게 움직일 수 있음

## 자율성에 관해
- 작은 팀들이 각자 맡은 업무를 수행할 수 있는 자율성을 보장해야 함
- 팀에게 더 많은 의사결정 권한을 부여하고 다른 팀과 업무를 지속적으로 조정하지 않고도 많은 작업을 수행할 수 있어야 함

## 강력한 소유권 대 공동 소유권
### 강력한 소우권
- 소유권이 강한 팀은 소프트웨어 변경에 대해 더많은 책임을 짐으로써 수반되는 모든 이점과 더 수준 높은 자율성을 갖게됨
- 강력한 소유권 모델을 채택 할수록 팀간의 조정은 덜 필요함으로 생산성이 증가될 수 있음

#### 강력한 소유권은 어디까지인가?
- 전체 수명주기 소유권 모델에 따라 설계, 변경, 배포, 운영, 폐기까지 맡아서 업무 수행
- 마이크로서비스를 활용하는 가장 합리적인 모델

### 공동 소유권
- 필요한 곳(병목이 발생하는 곳)에 인력을 배치하여 유연성을 확보 할 수 있음
- 공동 소유권으로 마이크로서비스를 개발한다면 서비스간 동일한 기술 사용한다는 것을 의미, 이는 주요 장점을 훼손시키는 일
- 팀간의 조정이 더 많이 필요하며 결합이 증가될 수 있음
- 소수의 개발자와 하나의 팀만 있는경우에는 상관 없음

### 팀수준 대 조직 수준
- 팀 내에서는 서로 효율적으로 협업해야 하기 위해 공동 소유권을 보장해야함
- 팀 구성원 모두가 코드베이스를 직접 변경할 수 있어야 함

### 균형 모델
- 공동 소유권을 지향할수록 일관된 작업 수행 방식을 유지 하는것이 중요
- 강력한 소유권은 더 많은 지역적 최적화가 가능함
- 팀 자체에 많은 책임을 부여하더라도 제공 조직에서 이러한 균형을 조정해주는 기능을 갖추는 것이 좋음

## 활성화 팀
- 활성화 팀은 스트림 정렬 팀을 지원하기 위해 일하는 팀
- 활성화 팀은 팀간에서 발생하고 있는 지역적 최적화를 인지하고 어느정도 통제하기 위해 필요

### 실천 공동체 (CoP)
- 동료 간의 공유와 학습을 촉진하는 교차 그룹
- CoP팀은 종종 활성화 팀이 필요한 것을 더 잘 이해하는데 필요한 중요한 통찰을 제공할 수 있음

### 플랫폼
- 마이크로서비스에 대한 상태관리, 로그집계, 인가 및 인증과 같은 기능을 플랫폼으로 구현하여 생산성을 크게 향상 시킬 수 있음
- 플랫폼을 통해 업무량을 크게 늘리지 않고도 더 많은 책임을 지게 할 수 있음

#### 플랫폼 팀
- 플랫폼팀의 사용자는 다른 개발자, 개발자의 요구사항과 피드백을 수용해야 함
- 플랫폼 팀에 속해 있다면 사람들이 직면하고 있는 문제가 무엇인지 알아내고 해당 문제를 돕기 위해 협력해야 함

#### 포장된 길
- 작업을 수행하는 방법을 명확하게 소통한 다음 그 작업을 쉽게 수행할 수 있는 메커니즘을 제공
- 일반 적인 사례를 쉽게 만드는 동시에 정당한 경우 예외를 위한 여지를 남겨두어야 함
- 플랫폼이 사용하기 쉽지 않거나 적합하지 않다면 그것을 우회하는 일이 발생할 수 있음

## 공유 마이크로서비스
### 너무 어려운 분할
- 마이크로서비스를 각 팀이 소유할 수 있는 조각으로 분리하는 비용이 너무 높음
- 해당 비용을 지불할 정도로 가치있는 일이라고 생각하지 않을 수 있음

### 횡단 변경 사항
- 조직의 구조와 아키텍처의 상호작용에 대한 핵심 내용은 팀간의 조정을 줄이는 것 하지만 일부 횡단 변경은 불가피

### 전달 병목 현상
- 한 서비스에서 다른 서비스 기능이 변경되기를 기다리는 일이 발생할 수 있음
- 공동 소유권은 직접 수행 또는 필요한 사람을 배치하여 이를 해결할 수 있음

## 내부 오픈 소스
- 공유 코드베이스 문제를 해결하기 위해 내부 오픈소스를 사용할 수 있음

### 핵심 커미터의 역할
- 신뢰된 커미터(핵심 팀)와 비신뢰 커미터(팀 외부에서 변경사항을 서브밋 하는 사람들)로 구분해야 함
- 핵심 소유권을 가진 팀은 변경 사항을 검토하고 승인하는 방법이 필요
- 게이트키퍼(핵심 팀원)은 변경사항을 검토하는데 시간은 할애할 수 밖에 없음

### 성숙도
- 서비스가 덜 안정적이거나 덜 성숭될수록 핵심 팀 외부의 사람들이 패치를 서브밋하도록 허용하는 것이 더 어려워짐

### 도구
- 내부 오픈 소스 모델을 잘 지원하려면 pull 요청을 서브밋할 수 있는 기능이 포함된 분산 버전 제어 도구를 사용해야함
- 조직의 규모에 따라 패치 요청을 논의하고 발전시키는 도구가 필요할 수도 있음
- 커미터가 소프트웨어를 빌드하거나 배포하고 다른 사람들이 사용할 수 있도록 매우 쉽게 만들어야 함

## 플러그 가능한 모듈식 마이크로 서비스
- 팀이 pull요청을 많이 받는다면 여러 팀에게 공유되는 마이크로서비스가 있다는 신호
- 특정 팀에서 pull요청을 많이 보내게 된다면 마이크로 서비스의 소유자 변경을 고려

#### 공통 프레임워크
- 공통 프레임워크를 사용하면 동일한 마이크로서비스에 대한 여려 변형을 다른 팀에서 운영할 수 있음
- 공통 프레임워크가 새로 릴리즈 되어도 배포할 권리는 각 팀에게 있음
- 하지만 내부 프레임워크를 만드는것은 매우 까다로운 작업임 

#### 라이브러리를 통한 외부 기여
- 팀은 커스텀 라이브러리를 개발하여 중앙 마이크로서비스에게 제공
- 중앙 마이크로서비스에게 배포 권한이 있기 때문에 릴리즈를 기다려야 함

### 변경사항 검토
- 내부 오픈 소스 방식을 채택할 때는 변경 사항을 승인하기 전에 검토해야 한다는 검토 개념이 핵심 원칙
- 직접 커밋 권한이 있는 코드베이스에서는 팀 내에서 작업할 때도 변경 사항을 검토하는 것이 여전히 가치가 있음
- 다른 개발자와 함께 코드를 작성하고 변경 사항데 대해 서로 논의하면서 체크인하기 전에 코드를 검토하는 페어프로그래밍을 선호

#### 동기식 및 비동기식 코드 검토
- 페어프로그래밍은 검토 작업과 변경 작업이 동시에 진행되므로 문제가 발견되면 즉시 수정됨
- 페어링 하지 않아도 코드를 작성한 직후 검토를 진행하는 것이 이상적
- 코드 변경에 대한 피드백을 더 빨리 받을수록 좋음, 늦어질 수록 수정에 대한 비용이 발생

#### 앙상블 프로그래밍
- 한 문제에 대해 집단적으로 작업하고 많은 개별 참여자에게서 입력을 받을 때 사용
- 힘의 불균형으로 집단적인 문제 해결이란 목표를 더 악화시킬 수도 있음

## 고아 서비스
- 기능이 적어 적극적으로 유지 보수되지 않는 서비스에 대한 소유권이 누군지 판단하기 여러움
- 여러 기술스택을 사용하는 경우 팀이 기술 스택을 더이상 알지 못하면 고아 서비스를 변경하는데 어려움이 가중될 것

## 사례 연구
- REA 회사는 사업분야를 분리하고 관련 IT팀(스쿼드)를 배치하여 전체 수명주기를 담당하게 만듬
- 핵심 제공 서비스 팀(활성화팀)은 각 사업분야의 스쿼드에 조언, 지침, 도구를 제공해 효율성을 높임
- 각 사업분야 내에서는 자유롭게 의사소통하고 다른 사업 분야와는 비동기 배치 방식으로 강제함
- 배치 통합만 잘되면 아무도 관여하지 않아 언제든지 서비스를 다운할 수 있었음
- 이러한 구조는 팀 사이 뿐만 아니라 다른 사업 부분사이에도 상당항 자율성을 주었고 큰 성공을 거두었음

## 지리적 분포
- 서로 다른 시간, 위치에 있는 팀원들간 동기적 의사소통 방식은 매우 제한적임
- 지리적으로 떨어진 두 위치에서 공동 소유권을 갖는 경우 더 전문화되고 코드베이스 일부에 대한 소유권을 가질 수 있음
- 시스템을 구축하는 조직이 더 느슨하게 결합돼 있는 경우 더 모듈화 되고 덜 결합되는 경향이 있음

## 콘웨이의 역법칙
- 조직 시스템 설계에 영향을 미치듯이 반대로 시스템 설계가 조직을 바꿀 수 있음
- 시스템 설계의 단점이 무엇이든 간에 변화를 만들기 위해 조직 구조를 변경해야 함

## 사람
- 직원의 비전과 능력을 파악하지 않은채 책음을 부여하면 나쁜 결과를 초래할 수 있음
- 마이크로서비스 전환하는 과정을 적응할 시간을 충분이 줘야함
- 직원의 책임을 분명히 하고, 그러한 책임이 왜 중요한지 명확히 설명해야 함
